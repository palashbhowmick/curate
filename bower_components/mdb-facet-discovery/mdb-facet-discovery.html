<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../mdb-title/mdb-title.html">
<link rel="import" href="../mdb-radio-list/mdb-radio-list.html">
<link rel="import" href="../mdb-search-box/mdb-search-box.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../paper-radio-button/paper-radio-button.html">

<!--
`mdb-facet-discovery`

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--mdb-facet-title` | Mixin applied to facet title | `{}`
`--mdb-facet-container-top-margin` | Top margin applied to facet row container | `20px`
`--mdb-facet-container` | Mixin applied to each facet row | `{}`
`--mdb-facet-search-box` | Mixin applied to facet search box | `{}`
`--mdb-facet` | Mixin applied to each facet | `{}`
`--mdb-facet-recommendation` | Mixin applied to each facet recommendation section | `{}`
`--mdb-facet-recommendation-button` | Mixin applied to each radio button recommendation section | `{}`

@demo demo/index.html 
-->

<dom-module id="mdb-facet-discovery">
  <template>
    <style>
       :host {
        display: block;
      }

       :host mdb-title {
        --mdb-title: {
          @apply(--mdb-facet-title);
        }
      }

       :host .facet {
        margin-top: var(--mdb-facet-container-top-margin, 20px);
        @apply(--layout);
        @apply(--layout-justified);
        @apply(--mdb-facet-container);
      }

       :host mdb-search-box {
        @apply(--mdb-facet-search-box);
      }

       :host paper-checkbox {
        @apply(--mdb-facet);
      }

       :host mdb-radio-list {
        --mdb-radio-list-button: {
          @apply(--mdb-facet-recommendation-button);
        }
        @apply(--mdb-facet-recommendation);
      }
    </style>
    <div>
      <mdb-title help-text="[[helpText]]" level="3">[[facetType]]</mdb-title>
      <mdb-search-box placeholder="Search [[_getPlaceholder(facetType)]]"></mdb-search-box>
      <template is="dom-repeat" items="{{facets}}">
        <div class="facet">
          <paper-checkbox>[[item.name]] ([[item.recommendationFactor]])</paper-checkbox>
          <template is="dom-if" if="{{_isDefineMode(mode)}}">
            <mdb-radio-list size="small" data-facet$="[[item.name]]" selected="{{item.recommended}}" on-paper-radio-group-changed="_facetRecommendationChanged">
              <paper-radio-button name="yes">YES</paper-radio-button>
              <paper-radio-button name="no">NO</paper-radio-button>
              <paper-radio-button name="maybe">MAYBE</paper-radio-button>
            </mdb-radio-list>
          </template>
        </div>
      </template>
    </div>
  </template>

  <script>
    Polymer({

      is: 'mdb-facet-discovery',

      properties: {
        facetType: {
          type: String,
          value: ''
        },

        helpText: {
          type: String,
          value: ''
        },

        mode: {
          type: String,
          value: '',
          reflectToAttribute: true
        },

        facets: {
          type: Array,
          value: []
        }
      },

      _getPlaceholder: function (type) {
        return (type || '').toLowerCase();
      },

      _facetRecommendationChanged: function (e) {
        var facet = e.currentTarget.attributes.getNamedItem('data-facet').value;
        this.fire('facet-recommendation-changed', {
          facet: facet,
          recommended: e.currentTarget.selected
        });
      },

      _isDefineMode: function (mode) {
        return mode === 'define';
      }

    });
  </script>
</dom-module>